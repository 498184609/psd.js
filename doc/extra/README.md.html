<!DOCTYPE html>
<html>
  <head>
  <meta charset='UTF-8'>
  <title>CoffeeScript API Documentation</title>
  <script src='../javascript/application.js'></script>
  <script src='../javascript/search.js'></script>
  <link rel='stylesheet' href='../stylesheets/application.css' type='text/css'>
</head>
  <body>
    <div id='base' data-path='../'></div>
<div id='header'>
  <div id='menu'>
    <a href='../extra/README.md.html' title='Psd'>
      Psd
    </a>
    &raquo;
    <a href='../alphabetical_index.html' title='Index'>
      Index
    </a>
    &raquo;
    <span class='title'>README.md</span>
  </div>
</div>
    <div id='content'>
      <nav class='toc'>
        <p class='title'>
          <a class='hide_toc' href='#'>
            <strong>Table of Contents</strong>
          </a>
          <small>
            (<a class='float_toc' href='#'>left</a>)
          </small>
        </p>
      </nav>
      <div id='filecontents'>
        <h1 id="psd-js">PSD.js</h1><p><a href="https://travis-ci.org/meltingice/psd.js"><img src="https://travis-ci.org/meltingice/psd.js.svg?branch=master" alt="Build Status"></a></p><p>A general purpose PSD parser written in Coffeescript. Based off of <a href="https://github.com/layervault/psd.rb">PSD.rb</a>. It allows you to work with a Photoshop document in a manageable tree structure and find out important data such as:</p><ul>
<li>Document structure</li>
<li>Document size</li>
<li>Layer/folder size + positioning</li>
<li>Layer/folder names</li>
<li>Layer/folder visibility and opacity</li>
<li>Font data (via <a href="https://github.com/layervault/psd-enginedata">psd-enginedata</a>)<ul>
<li>Text area contents</li>
<li>Font names, sizes, and colors</li>
</ul>
</li>
<li>Color mode and bit-depth</li>
<li>Vector mask data</li>
<li>Flattened image data</li>
<li>Layer comps</li>
</ul><p>Runs in both NodeJS and the browser (using browserify). There are still some pieces missing that are present in PSD.rb, such as layer comp filtering, a built-in renderer, and many layer info blocks. The eventual goal is full feature parity with PSD.rb.</p><h2 id="installation">Installation</h2><p>PSD.js has no native dependencies. Simply add <code>psd</code> to your package.json or run <code>npm install psd</code>.</p><h2 id="usage">Usage</h2><p>PSD.js works almost exactly the same in the browser and NodeJS.</p><h3 id="nodejs-example">NodeJS Example</h3>
<pre><code class="lang-js">var PSD = require(&#39;psd&#39;);
var psd = PSD.fromFile(&quot;path/to/file.psd&quot;);
psd.parse();

console.log(psd.tree().export());
console.log(psd.tree().childrenAtPath(&#39;A/B/C&#39;)[0].export());

// You can also use promises syntax for opening and parsing
PSD.open(&quot;path/to/file.psd&quot;).then(function (psd) {
  return psd.image.saveAsPng(&#39;./output.png&#39;);
}).then(function () {
  console.log(&quot;Finished!&quot;);
});
</code></pre>
<h3 id="browser-example">Browser Example</h3>
<pre><code class="lang-js">var PSD = require(&#39;psd&#39;);

// Load from URL
PSD.fromURL(&quot;/path/to/file.psd&quot;).then(function(psd) {
  document.getElementById(&#39;ImageContainer&#39;).appendChild(psd.image.toPng());
});

// Load from event, e.g. drag &amp; drop
function onDrop(evt) {
  PSD.fromEvent(evt).then(function (psd) {
    console.log(psd.tree().export());
  }); 
}
</code></pre>
<h3 id="traversing-the-document">Traversing the Document</h3><p>To access the document as a tree structure, use <code>psd.tree()</code> to get the root node. From there, work with the tree using any of these methods:</p><ul>
<li><code>root()</code>: get the root node from anywhere in the tree</li>
<li><code>isRoot()</code>: is this the root node?</li>
<li><code>children()</code>: get all immediate children of the node</li>
<li><code>hasChildren()</code>: does this node have any children?</li>
<li><code>childless()</code>: opposite of <code>hasChildren()</code></li>
<li><code>ancestors()</code>: get all ancestors in the path of this node (excluding the root)</li>
<li><code>siblings()</code>: get all sibling tree nodes including the current one (e.g. all layers in a folder)</li>
<li><code>nextSibling()</code>: gets the sibling immediately following the current node</li>
<li><code>prevSibling()</code>: gets the sibling immediately before the current node</li>
<li><code>hasSiblings()</code>: does this node have any siblings?</li>
<li><code>onlyChild()</code>: opposite of <code>hasSiblings()</code></li>
<li><code>descendants()</code>: get all descendant nodes not including the current one</li>
<li><code>subtree()</code>: same as descendants but starts with the current node</li>
<li><code>depth()</code>: calculate the depth of the current node (root node is 0)</li>
<li><code>path()</code>: gets the path to the current node</li>
</ul><p>If you know the path to a group or layer within the tree, you can search by that path. Note that this always returns an Array because layer/group names do not have to be unique. The search is always scoped to the descendants of the current node, as well.</p><pre><code class="lang-js">psd.tree().childrenAtPath(&#39;Version A/Matte&#39;);
psd.tree().childrenAtPath([&#39;Version A&#39;, &#39;Matte&#39;]);
</code></pre>
<h3 id="accessing-layer-data">Accessing Layer Data</h3><p>To get data such as the name or dimensions of a layer:</p><pre><code class="lang-js">node = psd.tree().descendants()[0];
node.get(&#39;name&#39;);
node.get(&#39;width&#39;);
</code></pre><p>PSD files also store various pieces of information in &quot;layer info&quot; blocks. See <a href="https://github.com/meltingice/psd.js/blob/master/lib/psd/layer/info.coffee">this file</a> for all of the possible layer info blocks that PSD.js parses (in <code>LAYER_INFO</code>). Which blocks a layer has varies from layer-to-layer, but to access them you can do:</p><pre><code class="lang-js">node = psd.tree().descendants()[0]
node.get(&#39;typeTool&#39;).export()
node.get(&#39;vectorMask&#39;).export()
</code></pre>
<h3 id="exporting-data">Exporting Data</h3><p>When working with the tree structure, you can recursively export any node to an object. This does not dump <em>everything</em>, but it does include the most commonly accessed information.</p><pre><code class="lang-js">console.log(psd.tree().export());
</code></pre><p>Which produces something like:</p><pre><code class="lang-js">{ children: 
   [ { type: &#39;group&#39;,
       visible: false,
       opacity: 1,
       blendingMode: &#39;normal&#39;,
       name: &#39;Version D&#39;,
       left: 0,
       right: 900,
       top: 0,
       bottom: 600,
       height: 600,
       width: 900,
       children: 
        [ { type: &#39;layer&#39;,
            visible: true,
            opacity: 1,
            blendingMode: &#39;normal&#39;,
            name: &#39;Make a change and save.&#39;,
            left: 275,
            right: 636,
            top: 435,
            bottom: 466,
            height: 31,
            width: 361,
            mask: {},
            text: 
             { value: &#39;Make a change and save.&#39;,
               font: 
                { name: &#39;HelveticaNeue-Light&#39;,
                  sizes: [ 33 ],
                  colors: [ [ 85, 96, 110, 255 ] ],
                  alignment: [ &#39;center&#39; ] },
               left: 0,
               top: 0,
               right: 0,
               bottom: 0,
               transform: { xx: 1, xy: 0, yx: 0, yy: 1, tx: 456, ty: 459 } },
            image: {} } ] } ],
    document: 
       { width: 900,
         height: 600,
         resources: 
          { layerComps: 
             [ { id: 692243163, name: &#39;Version A&#39;, capturedInfo: 1 },
               { id: 725235304, name: &#39;Version B&#39;, capturedInfo: 1 },
               { id: 730932877, name: &#39;Version C&#39;, capturedInfo: 1 } ],
            guides: [],
            slices: [] } } }
</code></pre><p>You can also export the PSD to a flattened image. Please note that, at this time, not all image modes + depths are supported.</p><pre><code class="lang-js">png = psd.image.toPng(); // get PNG object
psd.image.saveAsPng(&#39;path/to/output.png&#39;).then(function () {
  console.log(&#39;Exported!&#39;);
});
</code></pre><p>This uses the full rasterized preview provided by Photoshop. If the file was not saved with Compatibility Mode enabled, this will return an empty image.</p>
      </div>
    </div>
    <div id='footer'>
  May 11, 15 11:20:26 by
  <a href='https://github.com/coffeedoc/codo' title='CoffeeScript API documentation generator'>
    Codo
  </a>
  2.0.11
  &#10034;
  Press H to see the keyboard shortcuts
  &#10034;
  <a href='http://twitter.com/netzpirat' target='_parent'>@netzpirat</a>
  &#10034;
  <a href='http://twitter.com/_inossidabile' target='_parent'>@_inossidabile</a>
</div>
<iframe id='search_frame'></iframe>
<div id='fuzzySearch'>
  <input type='text'>
  <ol></ol>
</div>
<div id='help'>
  <p>
    Quickly fuzzy find classes, mixins, methods, file:
  </p>
  <ul>
    <li>
      <span>T</span>
      Open fuzzy finder dialog
    </li>
  </ul>
  <p>
    Control the navigation frame:
  </p>
  <ul>
    <li>
      <span>L</span>
      Toggle list view
    </li>
    <li>
      <span>C</span>
      Show class list
    </li>
    <li>
      <span>I</span>
      Show mixin list
    </li>
    <li>
      <span>F</span>
      Show file list
    </li>
    <li>
      <span>M</span>
      Show method list
    </li>
    <li>
      <span>E</span>
      Show extras list
    </li>
  </ul>
  <p>
    You can focus and blur the search input:
  </p>
  <ul>
    <li>
      <span>S</span>
      Focus search input
    </li>
    <li>
      <span>Esc</span>
      Blur search input
    </li>
  </ul>
</div>
  </body>
</html>