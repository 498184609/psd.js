<!DOCTYPE html><html><head><title>README</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="./docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="./index.html" class="source"><span class="file_name">README</span></a><a href="./lib/psd/blend_mode.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">blend_mode.coffee</span></a><a href="./lib/psd/channel_image.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">channel_image.coffee</span></a><a href="./lib/psd/color.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">color.coffee</span></a><a href="./lib/psd/descriptor.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">descriptor.coffee</span></a><a href="./lib/psd/file.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">file.coffee</span></a><a href="./lib/psd/header.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">header.coffee</span></a><a href="./lib/psd/image.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">image.coffee</span></a><a href="./lib/psd/image_export.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">image_export.coffee</span></a><a href="./lib/psd/image_exports/png.coffee.html" class="source "><span class="base_path">lib / psd / image_exports / </span><span class="file_name">png.coffee</span></a><a href="./lib/psd/image_format.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">image_format.coffee</span></a><a href="./lib/psd/image_formats/layer_raw.coffee.html" class="source "><span class="base_path">lib / psd / image_formats / </span><span class="file_name">layer_raw.coffee</span></a><a href="./lib/psd/image_formats/layer_rle.coffee.html" class="source "><span class="base_path">lib / psd / image_formats / </span><span class="file_name">layer_rle.coffee</span></a><a href="./lib/psd/image_formats/raw.coffee.html" class="source "><span class="base_path">lib / psd / image_formats / </span><span class="file_name">raw.coffee</span></a><a href="./lib/psd/image_formats/rle.coffee.html" class="source "><span class="base_path">lib / psd / image_formats / </span><span class="file_name">rle.coffee</span></a><a href="./lib/psd/image_mode.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">image_mode.coffee</span></a><a href="./lib/psd/image_modes/cmyk.coffee.html" class="source "><span class="base_path">lib / psd / image_modes / </span><span class="file_name">cmyk.coffee</span></a><a href="./lib/psd/image_modes/greyscale.coffee.html" class="source "><span class="base_path">lib / psd / image_modes / </span><span class="file_name">greyscale.coffee</span></a><a href="./lib/psd/image_modes/rgb.coffee.html" class="source "><span class="base_path">lib / psd / image_modes / </span><span class="file_name">rgb.coffee</span></a><a href="./lib/psd/init.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">init.coffee</span></a><a href="./lib/psd/layer/blend_modes.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">blend_modes.coffee</span></a><a href="./lib/psd/layer/blending_ranges.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">blending_ranges.coffee</span></a><a href="./lib/psd/layer/channel_image.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">channel_image.coffee</span></a><a href="./lib/psd/layer/helpers.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">helpers.coffee</span></a><a href="./lib/psd/layer/info.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">info.coffee</span></a><a href="./lib/psd/layer/mask.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">mask.coffee</span></a><a href="./lib/psd/layer/name.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">name.coffee</span></a><a href="./lib/psd/layer/position_channels.coffee.html" class="source "><span class="base_path">lib / psd / layer / </span><span class="file_name">position_channels.coffee</span></a><a href="./lib/psd/layer.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">layer.coffee</span></a><a href="./lib/psd/layer_info/blend_clipping_elements.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">blend_clipping_elements.coffee</span></a><a href="./lib/psd/layer_info/blend_interior_elements.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">blend_interior_elements.coffee</span></a><a href="./lib/psd/layer_info/fill_opacity.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">fill_opacity.coffee</span></a><a href="./lib/psd/layer_info/gradient_fill.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">gradient_fill.coffee</span></a><a href="./lib/psd/layer_info/layer_id.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">layer_id.coffee</span></a><a href="./lib/psd/layer_info/layer_name_source.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">layer_name_source.coffee</span></a><a href="./lib/psd/layer_info/legacy_typetool.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">legacy_typetool.coffee</span></a><a href="./lib/psd/layer_info/locked.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">locked.coffee</span></a><a href="./lib/psd/layer_info/metadata.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">metadata.coffee</span></a><a href="./lib/psd/layer_info/nested_section_divider.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">nested_section_divider.coffee</span></a><a href="./lib/psd/layer_info/object_effects.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">object_effects.coffee</span></a><a href="./lib/psd/layer_info/section_divider.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">section_divider.coffee</span></a><a href="./lib/psd/layer_info/solid_color.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">solid_color.coffee</span></a><a href="./lib/psd/layer_info/typetool.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">typetool.coffee</span></a><a href="./lib/psd/layer_info/unicode_name.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">unicode_name.coffee</span></a><a href="./lib/psd/layer_info/vector_mask.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">vector_mask.coffee</span></a><a href="./lib/psd/layer_info/vector_origination.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">vector_origination.coffee</span></a><a href="./lib/psd/layer_info/vector_stroke.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">vector_stroke.coffee</span></a><a href="./lib/psd/layer_info/vector_stroke_content.coffee.html" class="source "><span class="base_path">lib / psd / layer_info / </span><span class="file_name">vector_stroke_content.coffee</span></a><a href="./lib/psd/layer_info.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">layer_info.coffee</span></a><a href="./lib/psd/layer_mask.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">layer_mask.coffee</span></a><a href="./lib/psd/lazy_execute.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">lazy_execute.coffee</span></a><a href="./lib/psd/mask.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">mask.coffee</span></a><a href="./lib/psd/node.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">node.coffee</span></a><a href="./lib/psd/nodes/ancestry.coffee.html" class="source "><span class="base_path">lib / psd / nodes / </span><span class="file_name">ancestry.coffee</span></a><a href="./lib/psd/nodes/build_preview.coffee.html" class="source "><span class="base_path">lib / psd / nodes / </span><span class="file_name">build_preview.coffee</span></a><a href="./lib/psd/nodes/group.coffee.html" class="source "><span class="base_path">lib / psd / nodes / </span><span class="file_name">group.coffee</span></a><a href="./lib/psd/nodes/layer.coffee.html" class="source "><span class="base_path">lib / psd / nodes / </span><span class="file_name">layer.coffee</span></a><a href="./lib/psd/nodes/root.coffee.html" class="source "><span class="base_path">lib / psd / nodes / </span><span class="file_name">root.coffee</span></a><a href="./lib/psd/nodes/search.coffee.html" class="source "><span class="base_path">lib / psd / nodes / </span><span class="file_name">search.coffee</span></a><a href="./lib/psd/path_record.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">path_record.coffee</span></a><a href="./lib/psd/resource.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">resource.coffee</span></a><a href="./lib/psd/resource_section.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">resource_section.coffee</span></a><a href="./lib/psd/resources/layer_comps.coffee.html" class="source "><span class="base_path">lib / psd / resources / </span><span class="file_name">layer_comps.coffee</span></a><a href="./lib/psd/resources.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">resources.coffee</span></a><a href="./lib/psd/util.coffee.html" class="source "><span class="base_path">lib / psd / </span><span class="file_name">util.coffee</span></a><a href="./lib/psd.coffee.html" class="source "><span class="base_path">lib / </span><span class="file_name">psd.coffee</span></a><a href="./shims/init.coffee.html" class="source "><span class="base_path">shims / </span><span class="file_name">init.coffee</span></a><a href="./shims/png.coffee.html" class="source "><span class="base_path">shims / </span><span class="file_name">png.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"></th><th class="code"></th></tr></thead><tbody><tr id="section"><td class="docs"><h1>psd
</h1><p>A general purpose Photoshop file parser.</p><h3>Version</h3><p>3.1.0</p><h3>Repository</h3><p>git - git@github.com:meltingice/psd.js.git</p><h3>Dependencies </h3><ul><li><b>coffee-script </b><span>~ 1.7.1</span></li><li><b>jspack </b><span>~ 0.0.3</span></li><li><b>coffeescript-module </b><span>~ 0.2.1</span></li><li><b>parse-engine-data </b><span>~ 0.1</span></li><li><b>pngjs </b><span>~ 0.4.0</span></li><li><b>rsvp </b><span>~ 3.0.6</span></li><li><b>lodash </b><span>~ 2.4</span></li><li><b>iconv-lite </b><span>~ 0.4.4</span></li></ul><p></p></td><td id="content" class="code"><h1 id="psd-js">PSD.js</h1>
<p><a href="https://travis-ci.org/meltingice/psd.js"><img src="https://travis-ci.org/meltingice/psd.js.svg?branch=master" alt="Build Status"></a></p>
<p>A general purpose PSD parser written in Coffeescript. Based off of <a href="https://github.com/layervault/psd.rb">PSD.rb</a>. It allows you to work with a Photoshop document in a manageable tree structure and find out important data such as:</p>
<ul>
<li>Document structure</li>
<li>Document size</li>
<li>Layer/folder size + positioning</li>
<li>Layer/folder names</li>
<li>Layer/folder visibility and opacity</li>
<li>Font data (via <a href="https://github.com/layervault/psd-enginedata">psd-enginedata</a>)<ul>
<li>Text area contents</li>
<li>Font names, sizes, and colors</li>
</ul>
</li>
<li>Color mode and bit-depth</li>
<li>Vector mask data</li>
<li>Flattened image data</li>
<li>Layer comps</li>
</ul>
<p>Runs in both NodeJS and the browser (using browserify). There are still some pieces missing that are present in PSD.rb, such as layer comp filtering, a built-in renderer, and many layer info blocks. The eventual goal is full feature parity with PSD.rb.</p>
<h2 id="installation">Installation</h2>
<p>PSD.js has no native dependencies. Simply add <code>psd</code> to your package.json or run <code>npm install psd</code>.</p>
<h2 id="usage">Usage</h2>
<p>PSD.js works almost exactly the same in the browser and NodeJS.</p>
<h3 id="nodejs-example">NodeJS Example</h3>
<pre><code class="lang-js">var PSD = require(&#39;psd&#39;);
var psd = PSD.fromFile(&quot;path/to/file.psd&quot;);
psd.parse();

console.log(psd.tree().export());
console.log(psd.tree().childrenAtPath(&#39;A/B/C&#39;)[0].export());

// You can also use promises syntax for opening and parsing
PSD.open(&quot;path/to/file.psd&quot;).then(function (psd) {
  return psd.image.saveAsPng(&#39;./output.png&#39;);
}).then(function () {
  console.log(&quot;Finished!&quot;);
});
</code></pre>
<h3 id="browser-example">Browser Example</h3>
<pre><code class="lang-js">var PSD = require(&#39;psd&#39;);

// Load from URL
PSD.fromURL(&quot;/path/to/file.psd&quot;).then(function(psd) {
  document.getElementById(&#39;ImageContainer&#39;).appendChild(psd.image.toPng());
});

// Load from event, e.g. drag &amp; drop
function onDrop(evt) {
  PSD.fromEvent(evt).then(function (psd) {
    console.log(psd.tree().export());
  }); 
}
</code></pre>
<h3 id="traversing-the-document">Traversing the Document</h3>
<p>To access the document as a tree structure, use <code>psd.tree()</code> to get the root node. From there, work with the tree using any of these methods:</p>
<ul>
<li><code>root()</code>: get the root node from anywhere in the tree</li>
<li><code>isRoot()</code>: is this the root node?</li>
<li><code>children()</code>: get all immediate children of the node</li>
<li><code>hasChildren()</code>: does this node have any children?</li>
<li><code>childless()</code>: opposite of <code>hasChildren()</code></li>
<li><code>ancestors()</code>: get all ancestors in the path of this node (excluding the root)</li>
<li><code>siblings()</code>: get all sibling tree nodes including the current one (e.g. all layers in a folder)</li>
<li><code>nextSibling()</code>: gets the sibling immediately following the current node</li>
<li><code>prevSibling()</code>: gets the sibling immediately before the current node</li>
<li><code>hasSiblings()</code>: does this node have any siblings?</li>
<li><code>onlyChild()</code>: opposite of <code>hasSiblings()</code></li>
<li><code>descendants()</code>: get all descendant nodes not including the current one</li>
<li><code>subtree()</code>: same as descendants but starts with the current node</li>
<li><code>depth()</code>: calculate the depth of the current node (root node is 0)</li>
<li><code>path()</code>: gets the path to the current node</li>
</ul>
<p>If you know the path to a group or layer within the tree, you can search by that path. Note that this always returns an Array because layer/group names do not have to be unique. The search is always scoped to the descendants of the current node, as well.</p>
<pre><code class="lang-js">psd.tree().childrenAtPath(&#39;Version A/Matte&#39;);
psd.tree().childrenAtPath([&#39;Version A&#39;, &#39;Matte&#39;]);
</code></pre>
<h3 id="accessing-layer-data">Accessing Layer Data</h3>
<p>To get data such as the name or dimensions of a layer:</p>
<pre><code class="lang-js">node = psd.tree().descendants()[0];
node.get(&#39;name&#39;);
node.get(&#39;width&#39;);
</code></pre>
<p>PSD files also store various pieces of information in &quot;layer info&quot; blocks. See <a href="https://github.com/meltingice/psd.js/blob/master/lib/psd/layer/info.coffee">this file</a> for all of the possible layer info blocks that PSD.js parses (in <code>LAYER_INFO</code>). Which blocks a layer has varies from layer-to-layer, but to access them you can do:</p>
<pre><code class="lang-js">node = psd.tree().descendants()[0]
node.get(&#39;typeTool&#39;).export()
node.get(&#39;vectorMask&#39;).export()
</code></pre>
<h3 id="exporting-data">Exporting Data</h3>
<p>When working with the tree structure, you can recursively export any node to an object. This does not dump <em>everything</em>, but it does include the most commonly accessed information.</p>
<pre><code class="lang-js">console.log(psd.tree().export());
</code></pre>
<p>Which produces something like:</p>
<pre><code class="lang-js">{ children: 
   [ { type: &#39;group&#39;,
       visible: false,
       opacity: 1,
       blendingMode: &#39;normal&#39;,
       name: &#39;Version D&#39;,
       left: 0,
       right: 900,
       top: 0,
       bottom: 600,
       height: 600,
       width: 900,
       children: 
        [ { type: &#39;layer&#39;,
            visible: true,
            opacity: 1,
            blendingMode: &#39;normal&#39;,
            name: &#39;Make a change and save.&#39;,
            left: 275,
            right: 636,
            top: 435,
            bottom: 466,
            height: 31,
            width: 361,
            mask: {},
            text: 
             { value: &#39;Make a change and save.&#39;,
               font: 
                { name: &#39;HelveticaNeue-Light&#39;,
                  sizes: [ 33 ],
                  colors: [ [ 85, 96, 110, 255 ] ],
                  alignment: [ &#39;center&#39; ] },
               left: 0,
               top: 0,
               right: 0,
               bottom: 0,
               transform: { xx: 1, xy: 0, yx: 0, yy: 1, tx: 456, ty: 459 } },
            image: {} } ] } ],
    document: 
       { width: 900,
         height: 600,
         resources: 
          { layerComps: 
             [ { id: 692243163, name: &#39;Version A&#39;, capturedInfo: 1 },
               { id: 725235304, name: &#39;Version B&#39;, capturedInfo: 1 },
               { id: 730932877, name: &#39;Version C&#39;, capturedInfo: 1 } ],
            guides: [],
            slices: [] } } }
</code></pre>
<p>You can also export the PSD to a flattened image. Please note that, at this time, not all image modes + depths are supported.</p>
<pre><code class="lang-js">png = psd.image.toPng(); // get PNG object
psd.image.saveAsPng(&#39;path/to/output.png&#39;).then(function () {
  console.log(&#39;Exported!&#39;);
});
</code></pre>
<p>This uses the full rasterized preview provided by Photoshop. If the file was not saved with Compatibility Mode enabled, this will return an empty image.</p>
  </td></tr></tbody></table><div id="generated">generated Tue May 12 2015 11:04:03 GMT-0400 (EDT)  </div></div></body></html>